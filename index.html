<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvoluSer - Comunidad de Evonautas</title>
    <!-- Metadatos importantes para m√≥viles -->
    <meta name="theme-color" content="#005691">
    
    <!-- Librer√≠as Externas -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.8.0/vanilla-tilt.min.js"></script>

    <script>
        // Configuraci√≥n de Colores y Animaciones
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brandBlue: '#005691',
                        brandBlueLight: '#007ccb',
                        brandGreen: '#7AB800',
                        brandGreenLight: '#9bd81a',
                        brandDark: '#0f172a',
                        brandAmber: '#d97706',
                    },
                    fontFamily: {
                        heading: ['Montserrat', 'sans-serif'],
                        body: ['Open Sans', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'glow-entrance': 'glowEntrance 1.5s ease-out forwards',
                        'shimmer-text': 'shimmer 3s infinite linear',
                        'pop-in': 'popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                        'float-avatar': 'floatAvatar 4s ease-in-out infinite',
                        'crystal-shine': 'crystalShine 8s infinite',
                        'leaf-wind': 'leaf-wind 2s ease-in-out infinite',
                        'hug': 'group-hug 1.5s ease-in-out infinite',
                        'tractor': 'tractor-move 0.5s linear infinite',
                        'shield': 'shield-guard 2s ease-in-out infinite',
                        'propulsion': 'propulsion 0.1s infinite alternate',
                    },
                    keyframes: {
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } },
                        floatAvatar: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-8px)' } },
                        glowEntrance: { '0%': { opacity: 0, transform: 'scale(0.9) translateY(20px)', filter: 'blur(10px)' }, '100%': { opacity: 1, transform: 'scale(1) translateY(0)', filter: 'blur(0)' } },
                        shimmer: { '0%': { backgroundPosition: '-200% center' }, '100%': { backgroundPosition: '200% center' } },
                        popIn: { '0%': { opacity: 0, transform: 'scale(0.5) translateY(50px)' }, '100%': { opacity: 1, transform: 'scale(1) translateY(0)' } },
                        crystalShine: { '0%, 40%': { left: '-150%', opacity: '0' }, '50%': { opacity: '0.5' }, '60%': { left: '150%', opacity: '0' }, '100%': { left: '150%', opacity: '0' } },
                        'leaf-wind': { '0%, 100%': { transform: 'rotate(0deg)' }, '25%': { transform: 'rotate(15deg)' }, '50%': { transform: 'rotate(-10deg)' }, '75%': { transform: 'rotate(5deg)' } },
                        'group-hug': { '0%, 100%': { transform: 'scale(1)' }, '50%': { transform: 'scale(0.9)' } },
                        'tractor-move': { '0%': { transform: 'rotate(0deg)' }, '25%': { transform: 'rotate(-2deg)' }, '75%': { transform: 'rotate(2deg)' }, '100%': { transform: 'rotate(0deg)' } },
                        'shield-guard': { '0%, 100%': { transform: 'scale(1)' }, '50%': { transform: 'scale(1.1)' } },
                        'propulsion': { 
                            '0%': { transform: 'scale(0.9) translateY(-2px)', opacity: '0.8' }, 
                            '100%': { transform: 'scale(1.1) translateY(2px)', opacity: '1' } 
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { 
            font-family: 'Open Sans', sans-serif; 
            background-color: #f0f4f8; 
            overflow-x: hidden; 
            cursor: none; 
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        @media (hover: none) { body { cursor: auto; } #custom-cursor { display: none; } }

        /* FONDO CINEM√ÅTICO */
        .cinematic-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; overflow: hidden; }
        .cinematic-bg::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?q=80&w=2832&auto=format&fit=crop');
            background-size: cover; background-position: center;
            animation: kenBurns 120s infinite alternate ease-in-out;
        }
        .cinematic-bg::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, 
                rgba(255, 255, 255, 0.2) 0%, 
                rgba(0, 86, 145, 0.1) 60%, 
                rgba(122, 184, 0, 0.1) 100%);
        }
        @keyframes kenBurns { 0% { transform: scale(1); } 100% { transform: scale(1.1); } }

        #particles-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
        
        .glass-card { 
            background: rgba(255, 255, 255, 0.85); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.9); 
            box-shadow: 0 20px 60px rgba(0, 50, 100, 0.15); 
            position: relative;
            z-index: 10; 
        }
        
        .logo-card { background: rgba(255, 255, 255, 0.95); border-radius: 1.5rem; box-shadow: 0 15px 35px -5px rgba(0, 86, 145, 0.15), 0 0 20px rgba(255, 255, 255, 0.8) inset; border: 1px solid rgba(255, 255, 255, 1); display: inline-block; padding: 2rem; min-width: 300px; position: relative; z-index: 10; overflow: hidden; backdrop-filter: blur(10px); }
        .logo-card::after { content: ''; position: absolute; top: 0; left: -150%; width: 150%; height: 100%; background: linear-gradient(120deg, transparent 20%, rgba(255, 255, 255, 0.8) 40%, rgba(255, 255, 255, 1) 50%, rgba(255, 255, 255, 0.8) 60%, transparent 80%); transform: skewX(-25deg); animation: crystal-shine 6s infinite; pointer-events: none; }
        .logo-glow { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 160%; height: 160%; background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 60%); z-index: -1; filter: blur(40px); animation: pulse-slow 4s infinite; }

        .stagger-1 { animation: slideIn 0.6s ease-out both; animation-delay: 0.1s; }
        .stagger-2 { animation: slideIn 0.6s ease-out both; animation-delay: 0.2s; }
        .stagger-3 { animation: slideIn 0.6s ease-out both; animation-delay: 0.3s; }
        .stagger-4 { animation: slideIn 0.6s ease-out both; animation-delay: 0.4s; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        #custom-cursor { position: fixed; top: 0; left: 0; width: 30px; height: 30px; pointer-events: none; z-index: 9999; transform: translate(-50%, -50%); transition: transform 0.05s ease-out; display: flex; align-items: center; justify-content: center; }
        #custom-cursor::before { content: ''; position: absolute; width: 40px; height: 40px; background: radial-gradient(circle, rgba(122, 184, 0, 0.4) 0%, transparent 70%); border-radius: 50%; z-index: -1; }
        a:hover ~ #custom-cursor, button:hover ~ #custom-cursor, .cursor-pointer:hover ~ #custom-cursor { transform: translate(-50%, -50%) scale(1.5); }

        .neon-3d-wrapper { font-family: 'Montserrat', sans-serif; font-weight: 800; text-transform: uppercase; perspective: 1200px; display: flex; justify-content: center; flex-wrap: wrap; gap: 0.6em; }
        .neon-word { display: flex; white-space: nowrap; }
        .neon-letter { display: inline-block; color: #ffffff; position: relative; transform-style: preserve-3d; animation: elegant-spin 8s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite; text-shadow: 0 2px 15px rgba(0, 86, 145, 0.6); }
        @keyframes elegant-spin { 0%, 85% { transform: rotateY(0deg); color: #ffffff; text-shadow: 0 2px 15px rgba(0, 86, 145, 0.6); } 92% { color: #9bd81a; text-shadow: 0 0 25px rgba(155, 216, 26, 0.8), 0 0 10px #ffffff; } 100% { transform: rotateY(360deg); color: #ffffff; text-shadow: 0 2px 15px rgba(0, 86, 145, 0.6); } }
        .neon-letter:hover { color: #005691; text-shadow: 0 0 15px rgba(255, 255, 255, 0.8); transition: all 0.3s ease; }

        .interactive-card { 
            transition: all 0.3s ease; 
            transform-style: preserve-3d; 
        }
        .interactive-card:hover { transform: translateY(-5px); background: rgba(255,255,255, 1); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); }
        
        .metal-icon { background-clip: text; -webkit-background-clip: text; color: transparent; filter: drop-shadow(2px 4px 3px rgba(0,0,0,0.2)); background-size: 200% 200%; transition: all 0.3s ease; }
        .metal-blue { background-image: linear-gradient(135deg, #003056 0%, #005691 25%, #4dabf7 50%, #005691 75%, #002040 100%); }
        .metal-gray { background-image: linear-gradient(135deg, #2d3436 0%, #636e72 25%, #b2bec3 50%, #636e72 75%, #2d3436 100%); }
        .metal-green { background-image: linear-gradient(135deg, #2f5d02 0%, #5c8d03 25%, #b2f243 50%, #5c8d03 75%, #204000 100%); }
        .metal-amber { background-image: linear-gradient(135deg, #78350f 0%, #d97706 25%, #fbbf24 50%, #d97706 75%, #451a03 100%); }
        
        /* Animaciones en Hover */
        .group:hover .animate-leaf { animation: leaf-wind 2s ease-in-out infinite; transform-origin: top center; }
        .group:hover .animate-hug { animation: group-hug 1.5s ease-in-out infinite; }
        .group:hover .animate-tractor { animation: tractor-move 0.5s linear infinite; }
        .group:hover .animate-shield { animation: shield-guard 2s ease-in-out infinite; }

        .chat-bubble { position: relative; background: #ffffff; border-radius: 1.5rem; padding: 1.25rem; box-shadow: 0 10px 25px rgba(0,0,0,0.15); margin-bottom: 2rem; border-bottom-right-radius: 0; transition: all 0.3s ease-in-out; }
        .chat-bubble::after { content: ''; position: absolute; bottom: -10px; right: 20px; width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-top: 15px solid #ffffff; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        /* --- COHETE TOON 3D (SVG Vectorial) --- */
        .wandering-rocket {
            position: fixed;
            /* Z-Index 1: Detr√°s del texto pero sobre el fondo */
            z-index: 1; 
            width: 140px; 
            height: 140px;
            pointer-events: none;
            opacity: 0; /* JS subir√° a 1 */
            transition: left 1s linear, top 1s linear, transform 0.8s ease-in-out;
            display: flex; align-items: center; justify-content: center;
        }

        .rocket-svg {
            width: 100%; height: 100%;
            /* Filtro de sombra suave para dar profundidad 3D sin manchar */
            filter: drop-shadow(0 10px 10px rgba(0,0,0,0.3));
        }

        /* Humo (Puffs de Nube) */
        .rocket-smoke-puff {
            position: fixed; 
            width: 25px; height: 25px;
            /* Blanco denso con transparencia en los bordes */
            background: radial-gradient(circle, rgba(255,255,255,0.9) 20%, rgba(255,255,255,0) 70%);
            border-radius: 50%; 
            pointer-events: none; 
            z-index: 0; /* Detr√°s del cohete */
            animation: cloudExpand 2s forwards ease-out;
            filter: blur(4px);
        }
        @keyframes cloudExpand { 
            0% { transform: scale(0.5); opacity: 0.9; } 
            100% { transform: scale(3.5); opacity: 0; } 
        }
    </style>
</head>
<body class="text-gray-700 antialiased min-h-screen flex flex-col relative" id="document-body">
    <div id="custom-cursor"><i class="fas fa-leaf text-brandGreen text-opacity-90 text-xl transform -rotate-45 drop-shadow-md"></i></div>
    <div class="cinematic-bg"></div>
    <canvas id="particles-canvas"></canvas>

    <header class="pt-20 pb-32 relative overflow-hidden z-10">
        <div class="absolute top-10 left-1/2 transform -translate-x-1/2 w-[600px] h-[600px] bg-white rounded-full mix-blend-overlay filter blur-[120px] opacity-40 pointer-events-none"></div>
        <div class="container mx-auto px-6 text-center relative z-20">
            <div class="mb-14 relative inline-block">
                <div class="logo-glow"></div>
                <div class="logo-card animate-glow-entrance cursor-none">
                    <div class="flex flex-col items-center justify-center">
                        <img src="logo.png" alt="EvoluSer Logo" class="h-auto object-contain" style="max-height: 170px; max-width: 100%; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.1));" onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=EvoluSer&background=005691&color=fff&size=128';">
                    </div>
                </div>
            </div>
            <h1 class="text-4xl md:text-6xl font-extrabold mb-6 tracking-tight drop-shadow-2xl text-white bg-clip-text text-transparent bg-gradient-to-br from-white via-gray-100 to-gray-300" style="text-shadow: 0 4px 20px rgba(0,0,0,0.2);">Evoluci√≥n Integral</h1>
            <div class="h-1.5 w-24 bg-gradient-to-r from-brandBlue to-brandGreen mx-auto rounded-full mb-8 shadow-[0_0_20px_rgba(122,184,0,0.8)]"></div>
            <div id="slogan-container" class="neon-3d-wrapper text-lg md:text-2xl mt-4 mb-8 min-h-[50px] items-center tracking-widest"></div>
        </div>
    </header>

    <main class="container mx-auto px-4 -mt-24 relative z-30 mb-12 flex-grow">
        <!-- Navegaci√≥n -->
        <div class="glass-card rounded-full shadow-2xl p-2 flex justify-center max-w-lg mx-auto mb-10 transform transition-all hover:scale-[1.01] relative z-50">
            <button onclick="switchTab('carta')" id="btn-carta" class="flex-1 py-3 px-6 rounded-full text-sm font-bold uppercase tracking-wider transition-all duration-500 bg-brandBlue text-white shadow-lg ring-4 ring-brandBlue/30 cursor-none"><i class="fas fa-file-alt mr-2"></i> Propuesta</button>
            <button onclick="switchTab('brochure')" id="btn-brochure" class="flex-1 py-3 px-6 rounded-full text-sm font-bold uppercase tracking-wider transition-all duration-500 text-gray-500 hover:bg-white/50 hover:text-brandBlue cursor-none"><i class="fas fa-th-large mr-2"></i> Servicios</button>
        </div>

        <div class="glass-card rounded-3xl shadow-2xl p-8 md:p-14 min-h-[600px] relative overflow-hidden transition-all duration-500 z-40" id="main-content-area">
            
            <!-- VISTA CARTA -->
            <div id="view-carta" class="max-w-5xl mx-auto stagger-1">
                <div class="flex justify-between items-end border-b border-gray-300 pb-6 mb-8">
                    <div><span class="bg-gradient-to-r from-brandBlue to-brandBlueLight text-white text-xs font-bold px-4 py-1.5 rounded-full uppercase tracking-wider shadow-md">Propuesta Corporativa</span></div>
                    <div class="text-right"><p class="text-brandBlue font-bold text-sm">QUITO, ECUADOR</p><p class="text-gray-500 text-xs" id="currentDate"></p></div>
                </div>
                <div class="prose prose-lg text-gray-600 mx-auto leading-relaxed text-justify">
                    <h2 class="text-3xl font-heading font-bold text-gray-800 mb-2 text-left">Estimados Clientes,</h2>
                    <p class="text-xl text-brandBlue font-light mb-8 text-left">Presentamos una nueva forma de entender el crecimiento empresarial.</p>
                    <p class="mb-6">En un entorno empresarial cada vez m√°s exigente, el crecimiento real solo ocurre cuando cuidamos lo m√°s importante: <strong>las personas y el entorno que habitan</strong>.</p>
                    <p class="mb-6">Les presento a <strong>EvoluSer</strong>, no solo como proveedores, sino como sus aliados estrat√©gicos. Entendemos que una empresa exitosa del siglo XXI debe cumplir cuatro requisitos innegociables: ser <span class="text-brandBlue font-semibold">Humana</span>, garantizar la <span class="text-gray-800 font-semibold">Seguridad y Salud Ocupacional</span>, ser <span class="text-brandGreen font-semibold">Sostenible</span> y <span class="text-brandAmber font-semibold">Productiva</span>.</p>
                    <p class="text-sm text-gray-500 italic mt-8 mb-4 text-center">Haga clic en cada √°rea para conocer a nuestros directores:</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 my-6 not-prose">
                        <div class="interactive-card bg-white/70 p-4 rounded-xl border border-blue-100 cursor-pointer group hover:-translate-y-2 transition duration-300" onclick="openModal('humano')" data-tilt data-tilt-max="15" data-tilt-speed="400" data-tilt-glare data-tilt-max-glare="0.5">
                            <div class="flex flex-col items-center text-center">
                                <div class="w-20 h-20 flex items-center justify-center mb-3"><i class="fas fa-users text-6xl metal-icon metal-blue group-hover:animate-hug"></i></div>
                                <h4 class="font-bold text-gray-800 text-sm">Humano</h4>
                                <p class="text-[10px] text-gray-500 uppercase tracking-wide">Talento</p>
                                <span class="text-[10px] text-brandBlue mt-2 opacity-0 group-hover:opacity-100 transition-opacity">Ver Directora</span>
                            </div>
                        </div>
                        <div class="interactive-card bg-white/70 p-4 rounded-xl border border-gray-200 cursor-pointer group hover:-translate-y-2 transition duration-300" onclick="openModal('seguro')" data-tilt data-tilt-max="15" data-tilt-speed="400" data-tilt-glare data-tilt-max-glare="0.5">
                            <div class="flex flex-col items-center text-center">
                                <div class="w-20 h-20 flex items-center justify-center mb-3 relative"><i class="fas fa-shield-alt text-6xl metal-icon metal-gray absolute transition-all duration-500 group-hover:opacity-0 group-hover:scale-50"></i><i class="fas fa-user-shield text-6xl metal-icon metal-gray group-hover:animate-shield"></i></div>
                                <h4 class="font-bold text-gray-800 text-sm">S.S.O.</h4>
                                <p class="text-[10px] text-gray-500 uppercase tracking-wide">Seguridad y Salud</p>
                                <span class="text-[10px] text-gray-600 mt-2 opacity-0 group-hover:opacity-100 transition-opacity">Ver Director</span>
                            </div>
                        </div>
                        <div class="interactive-card bg-white/70 p-4 rounded-xl border border-green-100 cursor-pointer group hover:-translate-y-2 transition duration-300" onclick="openModal('sostenible')" data-tilt data-tilt-max="15" data-tilt-speed="400" data-tilt-glare data-tilt-max-glare="0.5">
                            <div class="flex flex-col items-center text-center">
                                <div class="w-20 h-20 flex items-center justify-center mb-3"><i class="fas fa-leaf text-6xl metal-icon metal-green group-hover:animate-leaf"></i></div>
                                <h4 class="font-bold text-gray-800 text-sm">Sostenible</h4>
                                <p class="text-[10px] text-gray-400 font-bold uppercase tracking-wide">Ambiente</p>
                                <span class="text-[10px] text-brandGreen mt-2 opacity-0 group-hover:opacity-100 transition-opacity">Ver Director</span>
                            </div>
                        </div>
                        <div class="interactive-card bg-white/70 p-4 rounded-xl border border-amber-100 cursor-pointer group hover:-translate-y-2 transition duration-300" onclick="openModal('agro')" data-tilt data-tilt-max="15" data-tilt-speed="400" data-tilt-glare data-tilt-max-glare="0.5">
                            <div class="flex flex-col items-center text-center">
                                <div class="w-20 h-20 flex items-center justify-center mb-3"><i class="fas fa-tractor text-6xl metal-icon metal-amber group-hover:animate-tractor"></i></div>
                                <h4 class="font-bold text-gray-800 text-sm">Agroindustrial</h4>
                                <p class="text-[10px] text-gray-400 font-bold uppercase tracking-wide">Calidad</p>
                                <span class="text-[10px] text-amber-600 mt-2 opacity-0 group-hover:opacity-100 transition-opacity">Ver Directora</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-12 flex items-center gap-5 border-t border-gray-100 pt-8 not-prose">
                        <div onclick="openModal('equipo')" class="w-16 h-16 bg-gradient-to-br from-brandBlue to-brandBlueLight rounded-full flex items-center justify-center text-white shadow-lg text-2xl cursor-pointer transition-transform duration-300 hover:scale-110" title="Ver Equipo Directivo"><i class="fas fa-pen-nib"></i></div>
                        <div><p class="font-heading font-bold text-xl text-gray-900">Equipo Directivo</p><p class="text-brandBlue font-semibold">EvoluSer Consultores</p><a href="mailto:evoluserec@gmail.com" class="text-sm text-gray-400 hover:text-brandBlue transition cursor-none">evoluserec@gmail.com</a></div>
                    </div>
                </div>
            </div>

            <!-- VISTA BROCHURE -->
            <div id="view-brochure" class="hidden">
                <div class="text-center mb-12 stagger-1">
                    <span class="text-brandGreen font-bold tracking-widest uppercase text-xs bg-green-50 px-3 py-1 rounded-full">Nuestro Portafolio</span>
                    <h2 class="text-4xl font-heading font-bold text-gray-800 mb-4 mt-4">Soluciones Integrales</h2>
                    <p class="text-lg text-gray-500 max-w-2xl mx-auto">Tecnolog√≠a, normativa y humanidad unidas.</p>
                </div>

                <div class="max-w-sm mx-auto mb-16 stagger-2 video-section">
                    <div class="bg-white p-2 rounded-2xl shadow-xl border border-gray-100 relative group">
                        <div class="absolute -inset-1 bg-gradient-to-r from-brandBlue to-brandGreen rounded-2xl blur opacity-25 group-hover:opacity-40 transition duration-1000"></div>
                        <div class="relative rounded-xl overflow-hidden bg-black flex justify-center aspect-[9/16]">
                            <iframe 
                                class="w-full h-full"
                                src="https://www.youtube.com/embed/VfmFZdAbAyQ?rel=0" 
                                title="EvoluSer Video" 
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                                referrerpolicy="strict-origin-when-cross-origin" 
                                allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                    <p class="text-center text-xs text-gray-400 mt-3 italic">Descubre nuestra filosof√≠a en acci√≥n</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 px-2">
                    <div class="stagger-1 h-full"><div class="bg-white/80 rounded-2xl p-6 shadow-lg hover:shadow-2xl transition-all h-full border-t-4 border-brandBlue group flex flex-col cursor-pointer" onclick="openModal('humano')" data-tilt data-tilt-max="10"><div class="w-full flex justify-center mb-6"><i class="fas fa-users text-6xl metal-icon metal-blue animate-hug"></i></div><h3 class="text-xl font-bold text-gray-800 mb-2">EvoluSer <span class="text-brandBlue">HUMANO</span></h3><p class="text-[10px] text-gray-400 font-bold uppercase tracking-wider mb-6">Gesti√≥n del Talento</p><ul class="space-y-3 text-sm text-gray-600 flex-grow"><li class="flex items-start"><i class="fas fa-check text-brandGreen mt-1 mr-2 text-xs"></i> Reclutamiento</li><li class="flex items-start"><i class="fas fa-check text-brandGreen mt-1 mr-2 text-xs"></i> Clima y Cultura</li><li class="flex items-start"><i class="fas fa-check text-brandGreen mt-1 mr-2 text-xs"></i> Soft Skills</li><li class="flex items-start"><i class="fas fa-check text-brandGreen mt-1 mr-2 text-xs"></i> Evaluaciones</li></ul></div></div>
                    <div class="stagger-2 h-full"><div class="bg-white/80 rounded-2xl p-6 shadow-lg hover:shadow-2xl transition-all h-full border-t-4 border-gray-600 group flex flex-col cursor-pointer" onclick="openModal('seguro')" data-tilt data-tilt-max="10"><div class="w-full flex justify-center mb-6 relative h-16"><i class="fas fa-shield-alt text-6xl metal-icon metal-gray absolute transition-all duration-500 group-hover:opacity-0 group-hover:scale-50"></i><i class="fas fa-user-shield text-6xl metal-icon metal-gray animate-shield"></i></div><h3 class="text-xl font-bold text-gray-800 mb-2">EvoluSer <span class="text-gray-600">S.S.O.</span></h3><p class="text-[10px] text-gray-400 font-bold uppercase tracking-wider mb-6">Seguridad y Salud Ocupacional</p><ul class="space-y-3 text-sm text-gray-600 flex-grow"><li class="flex items-start"><i class="fas fa-check text-brandGreen mt-1 mr-2 text-xs"></i> Normativa ISO</li><li class="flex items-start"><i class="fas fa-check text-brandGreen mt-1 mr-2 text-xs"></i> Auditor√≠as</li><li class="flex items-start"><i class="fas fa-check text-brandGreen mt-1 mr-2 text-xs"></i> Salud Ocupacional</li><li class="flex items-start"><i class="fas fa-check text-brandGreen mt-1 mr-2 text-xs"></i> Capacitaciones</li></ul></div></div>
                    <div class="stagger-3 h-full"><div class="bg-white/80 rounded-2xl p-6 shadow-lg hover:shadow-2xl transition-all h-full border-t-4 border-brandGreen group flex flex-col cursor-pointer" onclick="openModal('sostenible')" data-tilt data-tilt-max="10"><div class="w-full flex justify-center mb-6"><i class="fas fa-leaf text-6xl metal-icon metal-green animate-leaf"></i></div><h3 class="text-xl font-bold text-gray-800 mb-2">EvoluSer <span class="text-brandGreen">SOSTENIBLE</span></h3><p class="text-[10px] text-gray-400 font-bold uppercase tracking-wider mb-6">Medio Ambiente</p><ul class="space-y-3 text-sm text-gray-600 flex-grow"><li class="flex items-start"><i class="fas fa-check text-brandBlue mt-1 mr-2 text-xs"></i> Manejo Ambiental</li><li class="flex items-start"><i class="fas fa-check text-brandBlue mt-1 mr-2 text-xs"></i> Certificaciones</li><li class="flex items-start"><i class="fas fa-check text-brandBlue mt-1 mr-2 text-xs"></i> Eficiencia</li><li class="flex items-start"><i class="fas fa-check text-brandBlue mt-1 mr-2 text-xs"></i> Cultura Verde</li></ul></div></div>
                    <div class="stagger-4 h-full"><div class="bg-white/80 rounded-2xl p-6 shadow-lg hover:shadow-2xl transition-all h-full border-t-4 border-brandAmber group flex flex-col cursor-pointer" onclick="openModal('agro')" data-tilt data-tilt-max="10"><div class="w-full flex justify-center mb-6"><i class="fas fa-tractor text-6xl metal-icon metal-amber animate-tractor"></i></div><h3 class="text-xl font-bold text-gray-800 mb-2">EvoluSer <span class="text-amber-600">AGRO</span></h3><p class="text-[10px] text-gray-400 font-bold uppercase tracking-wider mb-6">Agroindustrial</p><ul class="space-y-3 text-sm text-gray-600 flex-grow"><li class="flex items-start"><i class="fas fa-check text-brandBlue mt-1 mr-2 text-xs"></i> Buenas Pr√°cticas (BPA)</li><li class="flex items-start"><i class="fas fa-check text-brandBlue mt-1 mr-2 text-xs"></i> Inocuidad Alimentaria</li><li class="flex items-start"><i class="fas fa-check text-brandBlue mt-1 mr-2 text-xs"></i> Industrializaci√≥n de Producto</li><li class="flex items-start"><i class="fas fa-check text-brandBlue mt-1 mr-2 text-xs"></i> Optimizaci√≥n Procesos</li></ul></div></div>
                </div>

                <div class="mt-16 text-center stagger-3 pb-4">
                    <a href="https://wa.me/593983900050" target="_blank" class="inline-flex items-center gap-3 bg-gradient-to-r from-brandGreen to-green-600 text-white font-bold py-4 px-10 rounded-full transition-all transform hover:scale-105 shadow-xl hover:shadow-green-500/30 group cursor-none mb-6">
                        <span>¬°S√© un EVONAUTA! Evoluciona hoy</span>
                        <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                    </a>
                    <div class="flex justify-center gap-4 mt-2 animate-pop-in" style="animation-delay: 1s; opacity: 0; animation-fill-mode: forwards;">
                        <button onclick="switchTab('empresas')" class="px-6 py-2 rounded-full border border-brandBlue text-brandBlue hover:bg-brandBlue hover:text-white transition-all text-sm font-semibold cursor-none transform hover:scale-105"><i class="fas fa-building mr-2"></i> Empresas</button>
                        <button onclick="switchTab('emprendedores')" class="px-6 py-2 rounded-full border border-brandGreen text-brandGreen hover:bg-brandGreen hover:text-white transition-all text-sm font-semibold cursor-none transform hover:scale-105"><i class="fas fa-lightbulb mr-2"></i> Emprendedores</button>
                    </div>
                </div>
            </div>

            <!-- VISTA EMPRESAS -->
            <div id="view-empresas" class="hidden max-w-5xl mx-auto">
                <div class="text-center mb-8"><span class="text-brandBlue font-bold tracking-widest uppercase text-xs bg-blue-50 px-3 py-1 rounded-full">Soluciones Corporativas</span><h2 class="text-3xl font-heading font-bold text-gray-800 mb-2 mt-4">Impulso Empresarial</h2><p class="text-gray-500">Estrategias a medida para cada etapa de tu organizaci√≥n.</p></div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white/80 p-6 rounded-2xl shadow-lg border-t-4 border-brandBlue hover:transform hover:-translate-y-2 transition duration-300">
                        <div class="text-center mb-4"><i class="fas fa-store text-4xl text-brandBlue"></i></div><h3 class="text-xl font-bold text-gray-800 text-center mb-2">PYMES</h3><p class="text-xs text-gray-500 text-center mb-4">Peque√±as y Medianas Empresas</p><ul class="text-sm text-gray-600 space-y-2 mb-6"><li><i class="fas fa-check text-brandGreen mr-2"></i> Optimizaci√≥n de Procesos</li><li><i class="fas fa-check text-brandGreen mr-2"></i> Cumplimiento Legal Laboral</li><li><i class="fas fa-check text-brandGreen mr-2"></i> Estructura Organizacional</li></ul>
                    </div>
                    <div class="bg-white/80 p-6 rounded-2xl shadow-lg border-t-4 border-brandDark hover:transform hover:-translate-y-2 transition duration-300">
                        <div class="text-center mb-4"><i class="fas fa-building text-4xl text-brandDark"></i></div><h3 class="text-xl font-bold text-gray-800 text-center mb-2">Corporativo</h3><p class="text-xs text-gray-500 text-center mb-4">Grandes Organizaciones</p><ul class="text-sm text-gray-600 space-y-2 mb-6"><li><i class="fas fa-check text-brandGreen mr-2"></i> Auditor√≠as ISO Integrales</li><li><i class="fas fa-check text-brandGreen mr-2"></i> Cultura y Clima Laboral</li><li><i class="fas fa-check text-brandGreen mr-2"></i> Sostenibilidad Corporativa</li></ul>
                    </div>
                    <div class="bg-white/80 p-6 rounded-2xl shadow-lg border-t-4 border-brandAmber hover:transform hover:-translate-y-2 transition duration-300">
                        <div class="text-center mb-4"><i class="fas fa-industry text-4xl text-brandAmber"></i></div><h3 class="text-xl font-bold text-gray-800 text-center mb-2">Industria</h3><p class="text-xs text-gray-500 text-center mb-4">Sector Productivo</p><ul class="text-sm text-gray-600 space-y-2 mb-6"><li><i class="fas fa-check text-brandGreen mr-2"></i> Seguridad Industrial (SSO)</li><li><i class="fas fa-check text-brandGreen mr-2"></i> Licencias Ambientales</li><li><i class="fas fa-check text-brandGreen mr-2"></i> Certificaciones de Calidad</li></ul>
                    </div>
                </div>
                <div class="text-center mt-8"><a href="https://wa.me/593983900050?text=Hola,%20busco%20soluciones%20para%20mi%20Empresa" target="_blank" class="inline-block bg-brandBlue text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-blue-700 transition cursor-none">Agendar Diagn√≥stico Empresarial</a><div class="mt-4"><button onclick="switchTab('carta')" class="text-sm text-gray-400 hover:text-brandBlue transition cursor-none">Volver al inicio</button></div></div>
            </div>

            <!-- VISTA EMPRENDEDORES -->
            <div id="view-emprendedores" class="hidden max-w-4xl mx-auto">
                <div class="text-center mb-8"><span class="text-brandGreen font-bold tracking-widest uppercase text-xs bg-green-50 px-3 py-1 rounded-full">Startups & Nuevos Negocios</span><h2 class="text-3xl font-heading font-bold text-gray-800 mb-2 mt-4">Tu Socio de Despegue</h2></div>
                <div class="bg-white/90 p-8 rounded-3xl shadow-xl border border-gray-100 flex flex-col md:flex-row items-center gap-8">
                    <div class="w-40 h-40 md:w-56 md:h-56 relative flex-shrink-0"><div class="absolute inset-0 bg-brandGreen/20 rounded-full animate-pulse-slow"></div><img src="imagen6.png" alt="Ev Emprendedora" class="w-full h-full object-contain relative z-10 drop-shadow-2xl"></div>
                    <div class="text-center md:text-left">
                        <h3 class="text-2xl font-bold text-brandBlue mb-2">¬°Hola! Soy Ev, tu Mentora Virtual</h3>
                        <p class="text-gray-600 mb-6 leading-relaxed">S√© lo dif√≠cil que es empezar. Por eso, en EvoluSer hemos dise√±ado un programa especial para emprendedores como t√∫. Te ayudamos a formalizar tu idea, cumplir con los requisitos legales b√°sicos y estructurar tu primer equipo de trabajo sin complicaciones.</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6"><div class="bg-blue-50 p-3 rounded-lg text-sm text-brandBlue font-semibold"><i class="fas fa-rocket mr-2"></i> Modelo de Negocio</div><div class="bg-green-50 p-3 rounded-lg text-sm text-brandGreen font-semibold"><i class="fas fa-file-contract mr-2"></i> Permisos B√°sicos</div><div class="bg-amber-50 p-3 rounded-lg text-sm text-brandAmber font-semibold"><i class="fas fa-users-cog mr-2"></i> Selecci√≥n del Primer Equipo</div><div class="bg-gray-50 p-3 rounded-lg text-sm text-gray-600 font-semibold"><i class="fas fa-chalkboard-teacher mr-2"></i> Mentoria Personalizada</div></div>
                        <a href="https://wa.me/593983900050?text=Hola%20Ev,%20tengo%20un%20emprendimiento%20y%20necesito%20ayuda" target="_blank" class="inline-block bg-gradient-to-r from-brandGreen to-green-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-green-500/50 transition transform hover:scale-105 cursor-none">Hablar con un Asesor Humano</a>
                    </div>
                </div>
                <div class="text-center mt-8"><button onclick="switchTab('carta')" class="text-sm text-gray-400 hover:text-brandBlue transition cursor-none">Volver al inicio</button></div>
            </div>
        </div>
    </main>

    <!-- VENTANA CHAT -->
    <div id="ai-chat-window" class="fixed bottom-28 right-6 w-80 md:w-96 glass-card rounded-2xl flex flex-col transition-all duration-300 transform scale-0 origin-bottom-right z-[90] hidden" style="height: 450px;">
        <div class="bg-gradient-to-r from-brandBlue to-brandGreen p-4 rounded-t-2xl flex justify-between items-center relative overflow-hidden">
            <div class="absolute inset-0 bg-white opacity-10 animate-pulse-slow"></div>
            <div class="flex items-center gap-3 z-10">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-lg overflow-hidden"><img src="logo.png" alt="Logo" class="w-full h-full object-contain p-1" onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=EvoluSer&background=005691&color=fff&size=128';"></div>
                <div><h4 class="text-white font-bold text-sm">Soy Ev (IA)</h4><p class="text-xs text-white/80">Tu copiloto Evonauta</p></div>
            </div>
            <button onclick="toggleChat()" class="text-white hover:text-gray-200 z-10 transition-transform hover:rotate-90"><i class="fas fa-times text-xl"></i></button>
        </div>
        <ul id="chat-box" class="flex-1 overflow-y-auto p-4 space-y-4 scrollbar-hide bg-white/60 backdrop-blur-sm">
            <li class="flex justify-start"><div class="bg-white text-gray-700 p-3 rounded-2xl rounded-tl-none shadow-sm max-w-[85%] text-sm border border-gray-100">¬°Hola! üëã Soy Ev, la IA experta de EvoluSer. <br>¬øEn qu√© puedo ayudarte hoy?</div></li>
        </ul>
        <div class="p-3 bg-white/80 border-t border-gray-100 rounded-b-2xl">
            <div class="flex items-center gap-2 bg-gray-50 rounded-full px-4 py-2 border border-gray-200 focus-within:border-brandBlue transition-colors">
                <textarea id="chat-input" rows="1" class="flex-1 bg-transparent border-none outline-none text-sm resize-none text-gray-700" placeholder="Preg√∫ntame algo..."></textarea>
                <button id="send-btn" class="text-brandBlue hover:text-brandGreen transition-colors transform hover:scale-110"><i class="fas fa-paper-plane"></i></button>
            </div>
            <div class="text-[10px] text-center text-gray-400 mt-1">Potenciado por xAI (Seguro)</div>
        </div>
    </div>
    
    <!-- AVATAR -->
    <div id="avatar-container" class="fixed bottom-6 right-6 z-[100] flex flex-col items-end pointer-events-none animate-pop-in" style="touch-action: none;">
        <div id="avatar-bubble" onclick="toggleChat()" class="chat-bubble mb-8 max-w-[280px] animate-float pointer-events-auto transform transition hover:scale-105 origin-bottom-right duration-300 cursor-pointer pointer-events-auto"><div id="bubble-content-default"><h4 class="font-bold text-brandBlue text-sm mb-1">¬°Hola, Evonauta! Soy Ev</h4><p class="text-xs text-gray-600 leading-snug mb-2">Haz clic para chatear con IA.</p></div></div>
        <div id="avatar-wrapper" onclick="toggleChat()" class="relative w-36 h-36 pointer-events-auto cursor-pointer active:cursor-grabbing group animate-float-avatar pointer-events-auto"><img src="imagen6.png" alt="Asistente" class="w-full h-full object-contain filter drop-shadow-2xl transition-transform duration-300 group-hover:scale-110" onerror="this.style.display='none'; document.getElementById('avatar-fallback').style.display='flex';"><div id="avatar-fallback" class="hidden w-full h-full bg-brandBlue rounded-full items-center justify-center text-white shadow-xl"><i class="fas fa-robot text-4xl"></i></div></div>
    </div>

    <!-- MODAL -->
    <div id="service-modal" class="fixed inset-0 z-[100] hidden items-center justify-center bg-black/70 backdrop-blur-sm p-4">
        <div class="bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto relative animate-float">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800 z-10 bg-white rounded-full p-2 shadow-md transition cursor-none"><i class="fas fa-times text-xl"></i></button>
            <div class="grid grid-cols-1 md:grid-cols-2">
                <div class="relative h-64 md:h-auto overflow-hidden bg-gray-100"><img id="modal-image" src="" alt="Servicio" class="w-full h-full object-cover transition duration-700 hover:scale-110"><div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent flex items-end p-6"><div class="text-white w-full"><p class="text-sm font-bold uppercase tracking-wider opacity-90 mb-1 drop-shadow-md" id="modal-subtitle">Dpto</p><div id="modal-title-container" class="flex items-center gap-3"><h3 class="text-3xl font-heading font-bold text-white drop-shadow-lg" id="modal-title">Titulo</h3></div></div></div></div>
                <div class="p-8 md:p-12 flex flex-col justify-center">
                    <div class="mb-6 border-l-4 border-brandBlue pl-4"><p class="text-xs text-gray-500 uppercase tracking-widest font-bold mb-1">Liderado por</p><h4 class="text-2xl font-bold text-gray-800" id="modal-leader">Nombre</h4><p class="text-brandBlue text-sm font-semibold" id="modal-role">Rol</p></div>
                    <div class="prose prose-sm text-gray-600 mb-8" id="modal-desc"></div>
                    <h5 class="font-bold text-gray-800 mb-3 text-sm uppercase tracking-wide border-b pb-2">Servicios Clave</h5><ul class="space-y-2 text-sm text-gray-600 mb-8" id="modal-list"></ul>
                    <button onclick="closeModal()" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3 rounded-xl transition cursor-none">Cerrar Perfil</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white/80 border-t border-gray-200 mt-auto backdrop-blur-sm relative z-30">
        <div class="container mx-auto px-6 py-10">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center text-center md:text-left">
                <div class="space-y-3">
                    <h5 class="font-bold text-gray-800 uppercase text-xs tracking-wider mb-4">Contacto Directo</h5>
                    <a href="tel:+593996408009" class="block text-gray-600 hover:text-brandBlue transition-colors cursor-none"><i class="fas fa-phone-alt w-6 text-brandGreen"></i> +593 99 640 8009</a>
                    <a href="https://wa.me/593983900050" class="block text-gray-600 hover:text-brandBlue transition-colors cursor-none"><i class="fab fa-whatsapp w-6 text-brandGreen"></i> +593 98 390 0050</a>
                    <a href="mailto:evoluserec@gmail.com" class="block text-gray-600 hover:text-brandBlue transition-colors cursor-none"><i class="fas fa-envelope w-6 text-brandGreen"></i> evoluserec@gmail.com</a>
                </div>
                <div class="text-center">
                   <p class="text-sm text-gray-400">¬© 2024 EvoluSer Consultores</p>
                   <p class="text-xs text-brandBlue font-bold mt-1 tracking-wider uppercase">Comunidad de Evonautas</p>
                   <p class="text-xs text-gray-300 mt-1">Quito, Ecuador</p>
                </div>
                <div class="text-center md:text-right">
                    <h5 class="font-bold text-gray-800 uppercase text-xs tracking-wider mb-4">Conecta con la Misi√≥n</h5>
                    <div class="flex justify-center md:justify-end space-x-4 mb-3">
                        <a href="https://www.linkedin.com/in/evoluser-ecuador-4b5462382/" target="_blank" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-brandBlue hover:text-white transition-all transform hover:scale-110 cursor-none" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="http://www.youtube.com/@EVOLUSEREC" target="_blank" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-red-600 hover:text-white transition-all transform hover:scale-110 cursor-none" title="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://www.facebook.com/share/14SRDeBzp77/" target="_blank" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-blue-600 hover:text-white transition-all transform hover:scale-110 cursor-none" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/evoluserec?igsh=bXB6dWN5ejAxd2Yw" target="_blank" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-pink-600 hover:text-white transition-all transform hover:scale-110 cursor-none" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="https://www.tiktok.com/@evoluserec?_r=1&_t=ZM-92aiiE2yhad" target="_blank" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-black hover:text-white transition-all transform hover:scale-110 cursor-none" title="TikTok"><i class="fab fa-tiktok"></i></a>
                        <a href="https://x.com/evoluserec" target="_blank" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-black hover:text-white transition-all transform hover:scale-110 cursor-none" title="X"><i class="fab fa-x-twitter"></i></a>
                    </div>
                    <p class="text-xs text-gray-500 italic">"√önete a la tripulaci√≥n y navega hacia la Evoluci√≥n. <br><span class="font-bold text-brandGreen">¬°S√© un Evonauta!</span>"</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // --- CONFIGURACI√ìN DE IA (CONEXI√ìN CLOUDFLARE) ---
        const USE_MOCK_AI = true; // ‚ö†Ô∏è CAMBIADO A TRUE TEMPORALMENTE (Para que funcione sin cr√©ditos)
        // Cuando recargues saldo en xAI, cambia esto a 'false'
        const BACKEND_URL = "https://cerebro-evoluser.comercialregionaldireccion.workers.dev"; // TU URL REAL

        let chatHistory = [];
        let isDragging = false, hasMoved = false, startX, startY;

        // --- SISTEMA DE SIMULACI√ìN (Respaldo en caso de error) ---
        const simulateGrokResponse = (text) => {
            const lowerText = text.toLowerCase();
            return new Promise((resolve) => {
                setTimeout(() => {
                    // --- SALUDOS Y CORTES√çA ---
                    if (lowerText.match(/^(hola|buenos|buenas|hi|hello)/)) {
                        resolve("¬°Hola, Evonauta! üöÄ Soy Ev, tu copiloto virtual. Estoy lista para despegar contigo hacia el √©xito. ¬øTe interesa Talento Humano, Seguridad, Ambiente o Agroindustria?");
                    } else if (lowerText.includes('gracias') || lowerText.includes('agradezco')) {
                        resolve("¬°Es un placer servirte! Recuerda que en EvoluSer estamos para potenciar el ser y proteger la vida. üíö ¬øNecesitas algo m√°s?");
                    } else if (lowerText.includes('adios') || lowerText.includes('chao') || lowerText.includes('hasta luego')) {
                        resolve("¬°Hasta pronto, Evonauta! Que tu viaje empresarial siga evolucionando. Estar√© aqu√≠ cuando me necesites. üöÄ");
                    
                    // --- IDENTIDAD ---
                    } else if (lowerText.includes('quien eres') || lowerText.includes('que eres') || lowerText.includes('tu nombre')) {
                        resolve("Soy Ev, la inteligencia artificial de EvoluSer. Mi misi√≥n es guiarte a trav√©s de nuestros servicios integrales y conectarte con nuestros expertos humanos.");
                    } else if (lowerText.includes('evoluser') || lowerText.includes('empresa') || lowerText.includes('hacen')) {
                        resolve("EvoluSer es una consultora integral en Ecuador. Fusionamos Talento Humano, Seguridad Ocupacional, Gesti√≥n Ambiental y Agroindustria para que tu empresa crezca cuidando a la gente y al planeta.");

                    // --- PRECIOS Y COSTOS ---
                    } else if (lowerText.includes('precio') || lowerText.includes('costo') || lowerText.includes('valor') || lowerText.includes('cotiza')) {
                        resolve("Cada proyecto es √∫nico, como tu huella digital. Para darte un valor exacto, necesitamos un diagn√≥stico r√°pido. ¬øTe gustar√≠a contactar a un asesor humano por WhatsApp? üì≤ üëâ <a href='https://wa.me/593983900050' target='_blank' class='text-brandBlue font-bold underline'>Clic aqu√≠</a>");
                    
                    // --- SERVICIOS ESPEC√çFICOS ---
                    // Talento Humano
                    } else if (lowerText.includes('humano') || lowerText.includes('talento') || lowerText.includes('clima') || lowerText.includes('reclutamiento')) {
                        resolve("En **Talento Humano** (Dir: Nury Echeverria), nos enfocamos en: <br>‚Ä¢ Selecci√≥n de personal üïµÔ∏è‚Äç‚ôÄÔ∏è<br>‚Ä¢ Clima y Cultura Laboral üå°Ô∏è<br>‚Ä¢ Habilidades Blandas üß†<br>¬°Potenciamos tu activo m√°s valioso!");
                    // Seguridad (SSO)
                    } else if (lowerText.includes('seguridad') || lowerText.includes('sso') || lowerText.includes('riesgo') || lowerText.includes('auditoria')) {
                        resolve("La seguridad es primero üõ°Ô∏è. (Dir: Christian Ortega). Ofrecemos:<br>‚Ä¢ Implementaci√≥n ISO 45001<br>‚Ä¢ Auditor√≠as de Riesgos<br>‚Ä¢ Vigilancia de la Salud<br>‚Ä¢ Capacitaciones de alto impacto.");
                    // Ambiente
                    } else if (lowerText.includes('ambiente') || lowerText.includes('sostenible') || lowerText.includes('licencia') || lowerText.includes('verde')) {
                        resolve("¬°El futuro es verde! üåø (Dir: Christian Ortega). Te ayudamos con:<br>‚Ä¢ Licencias Ambientales<br>‚Ä¢ Huella de Carbono<br>‚Ä¢ Planes de Manejo<br>Haz que tu empresa sea Sostenible y competitiva.");
                    // Agro
                    } else if (lowerText.includes('agro') || lowerText.includes('bpa') || lowerText.includes('inocuidad') || lowerText.includes('alimento')) {
                        resolve("Para el sector **Agroindustrial** üöú (Dir: Lilian Eras), optimizamos:<br>‚Ä¢ Buenas Pr√°cticas Agr√≠colas (BPA)<br>‚Ä¢ Inocuidad Alimentaria<br>‚Ä¢ Procesos de Industrializaci√≥n.<br>Calidad desde el origen.");
                    
                    // --- CONTACTO Y UBICACI√ìN ---
                    } else if (lowerText.includes('telefono') || lowerText.includes('celular') || lowerText.includes('llamar') || lowerText.includes('whatsapp')) {
                        resolve("Claro, cont√°ctanos directamente al WhatsApp: **+593 98 390 0050** o ll√°manos al **+593 99 640 8009**. ¬°Estamos atentos!");
                    } else if (lowerText.includes('correo') || lowerText.includes('email') || lowerText.includes('mail')) {
                        resolve("Escr√≠benos a: **evoluserec@gmail.com**. Revisamos nuestra bandeja de entrada constantemente. üìß");
                    } else if (lowerText.includes('ubicacion') || lowerText.includes('donde estan') || lowerText.includes('direccion') || lowerText.includes('quito')) {
                        resolve("Nuestra base de operaciones est√° en **Quito, Ecuador**, pero nuestros servicios llegan a todo el pa√≠s gracias a la tecnolog√≠a y a nuestros consultores m√≥viles. üåé");
                    
                    // --- FILOSOF√çA ---
                    } else if (lowerText.includes('mision') || lowerText.includes('proposito')) {
                        resolve("Nuestra misi√≥n es simple pero poderosa: **Potenciar el Ser, Proteger la Vida**. Buscamos que las empresas crezcan siendo m√°s humanas, seguras y sostenibles.");
                    } else if (lowerText.includes('vision')) {
                        resolve("Ser el referente nacional en consultor√≠a integral, demostrando que la rentabilidad y el bienestar humano/ambiental pueden ir de la mano.");

                    // --- DEFAULT ---
                    } else {
                        resolve("Entiendo tu consulta, pero mi base de datos simulada es limitada. üß† Te sugiero hablar directamente con nuestro equipo humano en WhatsApp para una respuesta experta y personalizada. ¬°Est√°n a un clic! üëâ <a href='https://wa.me/593983900050' target='_blank' class='text-brandBlue font-bold underline'>Clic aqu√≠ para chatear</a>");
                    }
                }, 1000); // Retardo para simular "pensamiento"
            });
        };

        // --- INICIALIZACI√ìN ---
        document.addEventListener('DOMContentLoaded', () => {
            createNeonText("POTENCIAR EL SER, PROTEGER LA VIDA");
            launchWanderingRocket();
            
            const sendBtn = document.getElementById('send-btn');
            const chatInput = document.getElementById('chat-input');
            const avatarContainer = document.getElementById('avatar-container');
            const serviceModal = document.getElementById('service-modal');

            if(sendBtn) sendBtn.addEventListener("click", handleChat);
            if(chatInput) chatInput.addEventListener("keydown", (e) => {
                if(e.key === "Enter" && !e.shiftKey) { e.preventDefault(); handleChat(); }
            });
            
            if(avatarContainer) {
                avatarContainer.addEventListener('mousedown', startDrag);
                avatarContainer.addEventListener('touchstart', startDrag, {passive: false});
            }

            if(serviceModal) {
                serviceModal.addEventListener('click', function(e) {
                    if (e.target === this) closeModal();
                });
            }

            const dateEl = document.getElementById('currentDate');
            if (dateEl) { dateEl.textContent = new Date().toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' }); }
        });

        // --- L√ìGICA DEL CHAT ---
        const createMessage = (text, type) => {
            const chatBox = document.getElementById('chat-box');
            const li = document.createElement("li");
            li.className = type === "outgoing" ? "flex justify-end" : "flex justify-start";
            const div = document.createElement("div");
            
            div.style.animation = "popIn 0.3s ease-out";
            div.className = type === "outgoing" ? 
                "bg-brandBlue text-white p-3 rounded-2xl rounded-tr-none shadow-md max-w-[85%] text-sm" : 
                "bg-white text-gray-700 p-3 rounded-2xl rounded-tl-none shadow-sm max-w-[85%] text-sm border border-gray-100";
            
            div.innerHTML = text.replace(/\n/g, "<br>");
            li.appendChild(div);
            chatBox.appendChild(li);
            chatBox.scrollTo({ top: chatBox.scrollHeight, behavior: 'smooth' });
            return div;
        }

        const handleChat = async () => {
            const chatInput = document.getElementById('chat-input');
            const userText = chatInput.value.trim();
            if (!userText) return;

            createMessage(userText, "outgoing");
            chatInput.value = "";
            chatInput.focus();

            // Indicador de "Escribiendo..."
            const loadingId = 'loading-' + Date.now();
            const loadingLi = document.createElement("li");
            loadingLi.className = "flex justify-start";
            loadingLi.id = loadingId;
            loadingLi.innerHTML = `
                <div class="bg-white text-gray-500 p-3 rounded-2xl rounded-tl-none shadow-sm border border-gray-100 flex items-center gap-2">
                    <i class="fas fa-circle-notch fa-spin text-brandBlue"></i> 
                    <span class="text-xs italic">Ev est√° pensando...</span>
                </div>`;
            document.getElementById('chat-box').appendChild(loadingLi);
            document.getElementById('chat-box').scrollTo({ top: document.getElementById('chat-box').scrollHeight, behavior: 'smooth' });

            try {
                let apiResponse;

                if (USE_MOCK_AI) {
                    apiResponse = await simulateGrokResponse(userText);
                } else {
                    // LLAMADA REAL A TU WORKER
                    const response = await fetch(BACKEND_URL, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ message: userText, history: chatHistory })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || "Error en el servidor");
                    }
                    const data = await response.json();
                    
                    if (data.error) throw new Error(data.error);
                    apiResponse = data.reply;
                }

                const loadingElement = document.getElementById(loadingId);
                if(loadingElement) loadingElement.remove();

                createMessage(apiResponse, "incoming");
                
                chatHistory.push({ role: "user", content: userText });
                chatHistory.push({ role: "assistant", content: apiResponse });
                if (chatHistory.length > 10) chatHistory = chatHistory.slice(-10);

            } catch (error) {
                console.error("Error Chat:", error);
                const loadingElement = document.getElementById(loadingId);
                if(loadingElement) loadingElement.remove();
                createMessage(`üì° Ups, tuve un problema: ${error.message}. Por favor intenta de nuevo.`, "incoming");
            }
        };

        // --- INTERFAZ EXTRA ---
        const cursor = document.getElementById('custom-cursor');
        document.addEventListener('mousemove', (e) => { 
            if(cursor) cursor.style.transform = `translate(${e.clientX}px, ${e.clientY}px)`; 
        });
        document.addEventListener('mouseenter', () => { if(cursor) cursor.style.display = 'flex'; });
        document.addEventListener('mouseleave', () => { if(cursor) cursor.style.display = 'none'; });

        // --- PART√çCULAS ---
        const canvas = document.getElementById('particles-canvas');
        if (canvas) {
            const ctx = canvas.getContext('2d'); let width, height, particles = [];
            function resize() { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; }
            class Particle {
                constructor() { this.reset(); }
                reset() {
                    this.x = Math.random() * width; 
                    this.y = Math.random() * height; 
                    this.vy = -(0.2 + Math.random() * 0.5); 
                    this.size = Math.random() * 2; 
                    this.alpha = Math.random() * 0.5;
                }
                update() { this.y += this.vy; if (this.y < 0) this.reset(); }
                draw() { 
                    ctx.fillStyle = `rgba(255, 255, 255, ${this.alpha})`; 
                    ctx.beginPath(); 
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); 
                    ctx.fill(); 
                }
            }
            function initParticles() { particles = []; for(let i=0; i<40; i++) particles.push(new Particle()); }
            function animateParticles() { ctx.clearRect(0, 0, width, height); particles.forEach(p => { p.update(); p.draw(); }); requestAnimationFrame(animateParticles); }
            window.addEventListener('resize', resize); resize(); initParticles(); animateParticles();
        }
        
        function switchTab(tabName) {
            const views = ['view-carta', 'view-brochure', 'view-empresas', 'view-emprendedores'];
            views.forEach(v => {
                const el = document.getElementById(v);
                if(el) el.classList.add('hidden');
            });
            
            const selected = document.getElementById('view-' + tabName);
            if(selected) {
                selected.classList.remove('hidden');
                const animatedElements = selected.querySelectorAll('.animate-pop-in, .stagger-1, .stagger-2, .stagger-3, .stagger-4');
                animatedElements.forEach(el => {
                    el.style.animation = 'none';
                    el.offsetHeight; 
                    el.style.animation = null; 
                });
            }

            const btnCarta = document.getElementById('btn-carta');
            const btnBrochure = document.getElementById('btn-brochure');
            
            if (tabName === 'carta' || tabName === 'empresas' || tabName === 'emprendedores') {
                btnCarta.className = "flex-1 py-3 px-6 rounded-full text-sm font-bold uppercase tracking-wider transition-all duration-500 bg-brandBlue text-white shadow-lg ring-4 ring-brandBlue/30 cursor-none";
                btnBrochure.className = "flex-1 py-3 px-6 rounded-full text-sm font-bold uppercase tracking-wider transition-all duration-500 text-gray-500 hover:bg-white/50 hover:text-brandBlue cursor-none";
            } else {
                btnBrochure.className = "flex-1 py-3 px-6 rounded-full text-sm font-bold uppercase tracking-wider transition-all duration-500 bg-brandBlue text-white shadow-lg ring-4 ring-brandBlue/30 cursor-none";
                btnCarta.className = "flex-1 py-3 px-6 rounded-full text-sm font-bold uppercase tracking-wider transition-all duration-500 text-gray-500 hover:bg-white/50 hover:text-brandBlue cursor-none";
            }
        }

        if (typeof VanillaTilt !== 'undefined') { VanillaTilt.init(document.querySelectorAll("[data-tilt]"), { max: 15, speed: 400 }); }

        function createNeonText(text) {
            const container = document.getElementById('slogan-container');
            if(!container) return;
            const words = text.split(' ');
            words.forEach(word => {
                const wordSpan = document.createElement('span');
                wordSpan.className = 'neon-word';
                word.split('').forEach((char, index) => {
                    const span = document.createElement('span');
                    span.innerText = char;
                    span.className = 'neon-letter';
                    span.style.animationDelay = `${index * 0.15}s`;
                    wordSpan.appendChild(span);
                });
                container.appendChild(wordSpan);
            });
        }

        function launchWanderingRocket() {
            const rocket = document.createElement('div');
            rocket.className = 'wandering-rocket';
            
            rocket.innerHTML = `
                <div class="rocket-container" style="transform: rotate(45deg);">
                    <svg viewBox="0 0 512 512" style="width: 100%; height: 100%; overflow: visible;">
                        <defs>
                            <linearGradient id="bodyGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#f0f4f8;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#d1d5db;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="windowGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#38bdf8;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#0284c7;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="finsGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#7AB800;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#005691;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <g transform="translate(256, 256)">
                            <ellipse cx="0" cy="-20" rx="70" ry="140" fill="url(#bodyGradient)" />
                            <path d="M-55 -100 Q0 -220 55 -100" fill="url(#finsGradient)" />
                            <path d="M-60 40 Q-100 100 -60 110 L-40 80 Z" fill="url(#finsGradient)" />
                            <path d="M60 40 Q100 100 60 110 L40 80 Z" fill="url(#finsGradient)" />
                            <rect x="-35" y="100" width="70" height="20" fill="#94a3b8" />
                            <circle cx="0" cy="-50" r="35" fill="#1e293b" />
                            <circle cx="0" cy="-50" r="25" fill="url(#windowGradient)" />
                            <circle cx="10" cy="-60" r="8" fill="white" opacity="0.4" />
                        </g>
                    </svg>
                </div>
            `;
            document.body.appendChild(rocket);
            
            setInterval(() => {
                const rect = rocket.getBoundingClientRect();
                const smoke = document.createElement('div');
                smoke.className = 'rocket-smoke-puff';
                
                const centerX = rect.left + rect.width/2;
                const centerY = rect.top + rect.height/2;
                
                smoke.style.left = `${centerX}px`;
                smoke.style.top = `${centerY}px`;
                
                document.body.appendChild(smoke);
                setTimeout(() => smoke.remove(), 2500);
            }, 200);

            function flyToNextPoint() {
                const margin = 80;
                const startX = Math.random() * (window.innerWidth - margin*2) + margin;
                const startY = Math.random() * (window.innerHeight - margin*2) + margin;
                const endX = Math.random() * (window.innerWidth - margin*2) + margin;
                const endY = Math.random() * (window.innerHeight - margin*2) + margin;

                const deltaX = endX - startX;
                const deltaY = endY - startY;
                const angle = Math.atan2(deltaY, deltaX) * 180 / Math.PI + 90;

                if (!rocket.style.left) {
                    rocket.style.left = '50%';
                    rocket.style.top = '50%';
                }

                const duration = Math.random() * 20 + 15; 
                
                rocket.style.transition = `left ${duration}s linear, top ${duration}s linear, transform 1.5s ease-in-out`; 
                
                requestAnimationFrame(() => {
                    rocket.style.opacity = '0.9'; 
                    rocket.style.transform = `rotate(${angle}deg)`;
                    rocket.style.left = `${endX}px`;
                    rocket.style.top = `${endY}px`;
                });
                
                setTimeout(flyToNextPoint, duration * 1000);
            }
            setTimeout(flyToNextPoint, 100);
        }

        const serviceData = {
            humano: { title: "EvoluSer HUMANO", icon: "fas fa-users", subtitle: "Gesti√≥n del Talento", leader: "Nury Echeverria", role: "Directora de Talento Humano", image: "imagen2.png", desc: "Creemos que el activo m√°s valioso es la gente. Bajo una direcci√≥n experta, transformamos la cultura organizacional mediante estrategias integrales de bienestar, desarrollo de habilidades blandas y diagn√≥sticos precisos que potencian el capital humano.", list: ["Reclutamiento y Selecci√≥n", "Clima y Cultura", "Soft Skills y Liderazgo", "Evaluaciones de Desempe√±o"], iconClass: "metal-blue", animation: "animate-hug" },
            seguro: { title: "EvoluSer S.S.O.", icon: "fas fa-shield-alt", subtitle: "Seguridad y Salud Ocupacional", leader: "Christian Ortega", role: "Director T√©cnico SST", image: "imagen3.png", desc: "La seguridad no es negociable. Lideramos un equipo t√©cnico enfocado en blindar tus operaciones, asegurando el estricto cumplimiento normativo y protegiendo la integridad de cada colaborador en todos los niveles.", list: ["Sistemas de Gesti√≥n ISO 45001", "Auditor√≠as de Riesgos", "Vigilancia de Salud", "Capacitaci√≥n T√©cnica"], iconClass: "metal-gray", animation: "animate-shield" },
            sostenible: { title: "EvoluSer SOSTENIBLE", icon: "fas fa-leaf", subtitle: "Medio Ambiente", leader: "Christian Ortega", role: "Director de Sostenibilidad", image: "imagen4.png", desc: "El futuro es verde. Integramos la visi√≥n ambiental directamente en tu estrategia de negocio, gestionando planes de manejo y certificaciones que no solo cumplen la ley, sino que te diferencian competitivamente en el mercado.", list: ["Planes de Manejo Ambiental", "Certificaciones Verdes", "Eficiencia Energ√©tica", "Cultura Ambiental Corporativa"], iconClass: "metal-green", animation: "animate-leaf" },
            agro: { title: "EvoluSer AGRO", icon: "fas fa-tractor", subtitle: "Agroindustrial", leader: "Lilian Eras", role: "Directora Agroindustrial", image: "imagen5.png", desc: "Calidad desde el origen. Aportamos una vasta experiencia t√©cnica para optimizar procesos agroindustriales, garantizando la inocuidad alimentaria y el cumplimiento riguroso de buenas pr√°cticas desde el campo hasta la mesa, incluyendo la transformaci√≥n del producto.", list: ["Buenas Pr√°cticas Agr√≠colas (BPA)", "Inocuidad Alimentaria", "Industrializaci√≥n de Producto", "Optimizaci√≥n de Procesos"], iconClass: "metal-amber", animation: "animate-tractor" },
            equipo: { title: "Equipo Directivo", icon: "fas fa-pen-nib", subtitle: "EvoluSer Consultores", leader: "Junta Directiva", role: "Liderazgo Estrat√©gico", image: "imagen7.jpeg", desc: "Nuestro equipo directivo encarna la misi√≥n de potenciar el ser y proteger la vida. Guiamos a la organizaci√≥n con una visi√≥n integral, asegurando que cada paso que damos genere valor real para nuestros clientes y la sociedad.", list: ["Direcci√≥n Estrat√©gica", "Gesti√≥n de Calidad", "Innovaci√≥n Corporativa", "Responsabilidad Social"], iconClass: "metal-blue" }
        };

        function openModal(type) {
            const data = serviceData[type];
            if(!data) return;
            document.getElementById('modal-image').src = data.image; 
            document.getElementById('modal-image').onerror = function() { this.src = 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=800&q=80'; };
            document.getElementById('modal-title').innerHTML = `<i class="${data.icon} text-4xl mr-3 metal-icon ${data.iconClass}"></i>${data.title}`;
            document.getElementById('modal-subtitle').innerText = data.subtitle; 
            document.getElementById('modal-leader').innerText = data.leader; 
            document.getElementById('modal-role').innerText = data.role; 
            document.getElementById('modal-desc').innerText = data.desc;
            
            const listEl = document.getElementById('modal-list');
            listEl.innerHTML = '';
            const colorClass = type === 'humano' ? 'text-brandBlue' : type === 'seguro' ? 'text-gray-600' : type === 'sostenible' ? 'text-brandGreen' : 'text-brandAmber';
            data.list.forEach(item => {
                listEl.innerHTML += `<li class="flex items-center"><i class="fas fa-check-circle mr-2 ${colorClass}"></i> ${item}</li>`;
            });

            const modal = document.getElementById('service-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeModal() {
            const modal = document.getElementById('service-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        function toggleChat() {
            const chatWindow = document.getElementById('ai-chat-window');
            const avatarBubble = document.getElementById('avatar-bubble');
            if (chatWindow.classList.contains('hidden')) {
                chatWindow.classList.remove('hidden');
                setTimeout(() => chatWindow.classList.remove('scale-0'), 10);
                avatarBubble.classList.add('opacity-0');
            } else {
                chatWindow.classList.add('scale-0');
                setTimeout(() => chatWindow.classList.add('hidden'), 300);
                avatarBubble.classList.remove('opacity-0');
            }
        }

        function startDrag(e) {
            const avatarContainer = document.getElementById('avatar-container');
            if (e.target.closest('#avatar-bubble')) return;
            const clientX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
            const clientY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;
            startX = clientX; startY = clientY;
            isDragging = false; hasMoved = false;
            document.addEventListener('mousemove', onDrag);
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchmove', onDrag, {passive: false});
            document.addEventListener('touchend', endDrag);
        }

        function onDrag(e) {
            const avatarContainer = document.getElementById('avatar-container');
            const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
            const clientY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
            if (Math.abs(clientX - startX) > 10 || Math.abs(clientY - startY) > 10) {
                isDragging = true; hasMoved = true;
                e.preventDefault();
                const rect = avatarContainer.getBoundingClientRect();
                avatarContainer.style.left = (rect.left + (clientX - startX)) + 'px';
                avatarContainer.style.top = (rect.top + (clientY - startY)) + 'px';
                startX = clientX; startY = clientY;
                avatarContainer.classList.remove('bottom-6', 'right-6');
            }
        }

        function endDrag(e) {
            document.removeEventListener('mousemove', onDrag);
            document.removeEventListener('mouseup', endDrag);
            document.removeEventListener('touchmove', onDrag);
            document.removeEventListener('touchend', endDrag);
            if (!hasMoved && !e.target.closest('#avatar-bubble')) {
                 toggleChat();
            }
        }
    </script>
</body>
</html>
